jenkins:
  securityRealm:
    local:
      allowsSignup: false
      users:
        - id: ${ADMIN_USER}
          password: ${ADMIN_PASSWORD}
  authorizationStrategy:
    loggedInUsersCanDoAnything:
      allowAnonymousRead: false

unclassified:
  location:
    url: http://52.74.52.230:8080/
  github:
    hookUrl: http://52.74.52.230:8080/github-webhook/

credentials:
  system:
    domainCredentials:
      - credentials:
          - usernamePassword:
              id: "github-credentials"
              username: "${GITHUB_USER}"
              password: "${GITHUB_TOKEN}"
              description: "GitHub PAT for webhook/pipeline access"

jobs:
  - script: >
      organizationFolder('coding-test-org') {
        description('GitHub repo for automated Docker info retrieval')
        displayName('Coding Test Org')

        organizations {
          github {
            repoOwner('dythia102')
            credentialsId('github-credentials')
            apiUri('https://api.github.com')
          }
        }

        projectFactories {
          workflowMultiBranchProjectFactory {
            scriptPath('Jenkinsfile')
          }
        }

        triggers {
          periodicFolderTrigger {
            interval('1d')
          }
        }

        orphanedItemStrategy {
          discardOldItems {
            daysToKeep(7)
            numToKeep(10)
          }
        }
      }
